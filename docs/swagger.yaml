basePath: /
definitions:
  handlers.CallNextRequest:
    properties:
      window_number:
        type: integer
    required:
    - window_number
    type: object
  handlers.CompleteAppointmentRequest:
    properties:
      ticket_id:
        example: 1
        type: integer
    required:
    - ticket_id
    type: object
  handlers.ConfirmationRequest:
    description: Запрос подтверждения действия (печать талона или получение электронного)
    properties:
      action:
        example: print_ticket
        type: string
      service_id:
        example: make_appointment
        type: string
    required:
    - action
    - service_id
    type: object
  handlers.ConfirmationResponse:
    description: Ответ после подтверждения действия
    properties:
      message:
        example: Ваш электронный талон
        type: string
      service_name:
        example: Записаться к врачу
        type: string
      ticket_number:
        example: A001
        type: string
      timeout:
        example: 10
        type: integer
    type: object
  handlers.DoctorScreenResponse:
    properties:
      doctor_name:
        type: string
      doctor_specialty:
        type: string
      is_waiting:
        type: boolean
      office_number:
        type: integer
      ticket_number:
        type: string
    type: object
  handlers.ServiceSelectionRequest:
    description: Запрос для выбора услуги
    properties:
      service_id:
        example: make_appointment
        type: string
    required:
    - service_id
    type: object
  handlers.ServiceSelectionResponse:
    description: Ответ после выбора услуги
    properties:
      action:
        example: confirm_print
        type: string
      service_name:
        example: Записаться к врачу
        type: string
    type: object
  handlers.StartAppointmentRequest:
    properties:
      ticket_id:
        example: 1
        type: integer
    required:
    - ticket_id
    type: object
  handlers.UpdateStatusRequest:
    description: Запрос для смены статуса тикета
    properties:
      status:
        type: string
    required:
    - status
    type: object
  models.DeleteRequest:
    properties:
      filters:
        $ref: '#/definitions/models.Filters'
    required:
    - filters
    type: object
  models.FilterCondition:
    properties:
      field:
        type: string
      operator:
        type: string
      value: {}
    type: object
  models.Filters:
    properties:
      conditions:
        items:
          $ref: '#/definitions/models.FilterCondition'
        type: array
      logical_operator:
        type: string
    type: object
  models.GetDataRequest:
    properties:
      filters:
        $ref: '#/definitions/models.Filters'
      limit:
        type: integer
      page:
        type: integer
    type: object
  models.InsertRequest:
    properties:
      data: {}
    required:
    - data
    type: object
  models.TicketResponse:
    description: Ответ API с данными талона
    properties:
      called_at:
        type: string
      completed_at:
        type: string
      created_at:
        type: string
      id:
        type: integer
      qr_code:
        items:
          type: integer
        type: array
      service_type:
        type: string
      started_at:
        type: string
      status:
        $ref: '#/definitions/models.TicketStatus'
      ticket_number:
        type: string
      window_number:
        type: integer
    type: object
  models.TicketStatus:
    enum:
    - ожидает
    - приглашен
    - на_приеме
    - завершен
    - зарегистрирован
    type: string
    x-enum-comments:
      StatusInvited: Пациент вызван к окну
    x-enum-varnames:
    - StatusWaiting
    - StatusInvited
    - StatusInProgress
    - StatusCompleted
    - StatusRegistered
  models.UpdateRequest:
    properties:
      data:
        additionalProperties: true
        type: object
      filters:
        $ref: '#/definitions/models.Filters'
    required:
    - data
    - filters
    type: object
  services.Service:
    properties:
      id:
        type: string
      letter:
        type: string
      name:
        type: string
    type: object
host: localhost:8080
info:
  contact: {}
  description: API для системы электронной очереди
  title: Electronic Queue API
  version: "1.0"
paths:
  /api/database/{table}/delete:
    delete:
      consumes:
      - application/json
      description: Позволяет удалить записи из указанной таблицы по заданным фильтрам.
      parameters:
      - description: Имя таблицы для удаления (e.g., tickets, doctors)
        in: path
        name: table
        required: true
        type: string
      - description: Фильтры для удаления
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/models.DeleteRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Данные успешно удалены
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Ошибка в запросе (например, удаление без фильтров)
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Отсутствует ключ API
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Неверный ключ API
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Внутренняя ошибка сервера
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - ApiKeyAuth: []
      summary: Удаление данных из таблицы
      tags:
      - database
  /api/database/{table}/insert:
    post:
      consumes:
      - application/json
      description: Позволяет вставить одну или несколько записей в указанную таблицу.
      parameters:
      - description: Имя таблицы для вставки (e.g., services, doctors)
        in: path
        name: table
        required: true
        type: string
      - description: Данные для вставки
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/models.InsertRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Данные успешно вставлены
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Ошибка в запросе
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Отсутствует ключ API
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Неверный ключ API
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Внутренняя ошибка сервера
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - ApiKeyAuth: []
      summary: Вставка данных в таблицу
      tags:
      - database
  /api/database/{table}/select:
    post:
      consumes:
      - application/json
      description: Позволяет получить данные из указанной таблицы с фильтрацией и
        пагинацией.
      parameters:
      - description: Имя таблицы для получения данных (e.g., tickets, doctors)
        in: path
        name: table
        required: true
        type: string
      - description: Фильтры и параметры пагинации
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/models.GetDataRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Успешный ответ с данными
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Ошибка в запросе (неверная таблица, поле или оператор)
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Отсутствует ключ API
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Неверный ключ API
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Внутренняя ошибка сервера
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - ApiKeyAuth: []
      summary: Получение данных из таблицы
      tags:
      - database
  /api/database/{table}/update:
    patch:
      consumes:
      - application/json
      description: Позволяет обновить записи в указанной таблице по заданным фильтрам.
      parameters:
      - description: Имя таблицы для обновления (e.g., tickets, doctors)
        in: path
        name: table
        required: true
        type: string
      - description: Данные и фильтры для обновления
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/models.UpdateRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Данные успешно обновлены
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Ошибка в запросе (например, обновление без фильтров)
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Отсутствует ключ API
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Неверный ключ API
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Внутренняя ошибка сервера
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - ApiKeyAuth: []
      summary: Обновление данных в таблице
      tags:
      - database
  /api/doctor/complete-appointment:
    post:
      consumes:
      - application/json
      description: Завершает прием пациента по талону
      parameters:
      - description: Данные для завершения приема
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handlers.CompleteAppointmentRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Appointment completed successfully
          schema:
            additionalProperties: true
            type: object
        "400":
          description: ticket_id is required or error message
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Завершить прием пациента
      tags:
      - doctor
  /api/doctor/screen-updates:
    get:
      description: Отправляет начальное состояние и последующие обновления статуса
        приема через Server-Sent Events.
      produces:
      - text/event-stream
      responses:
        "200":
          description: Поток событий
          schema:
            $ref: '#/definitions/handlers.DoctorScreenResponse'
      summary: Получить обновления для табло врача
      tags:
      - doctor
  /api/doctor/start-appointment:
    post:
      consumes:
      - application/json
      description: Начинает прием пациента по талону
      parameters:
      - description: Данные для начала приема
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handlers.StartAppointmentRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Appointment started successfully
          schema:
            additionalProperties: true
            type: object
        "400":
          description: ticket_id is required or error message
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Начать прием пациента
      tags:
      - doctor
  /api/registrar/call-next:
    post:
      consumes:
      - application/json
      description: Находит первого пациента в очереди, меняет его статус на "приглашен"
        и присваивает номер окна
      parameters:
      - description: Номер окна, которое вызывает пациента
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handlers.CallNextRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Данные вызванного талона
          schema:
            $ref: '#/definitions/models.TicketResponse'
        "400":
          description: 'Ошибка: неверный номер окна'
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: 'Ошибка: очередь пуста'
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Внутренняя ошибка сервера
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Вызвать следующего пациента
      tags:
      - registrar
  /api/registrar/tickets/{id}:
    delete:
      consumes:
      - application/json
      description: Удаляет тикет по ID
      parameters:
      - description: ID тикета
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Тикет удален
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Ошибка запроса
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Тикет не найден
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Внутренняя ошибка сервера
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Удалить тикет
      tags:
      - registrar
  /api/registrar/tickets/{id}/status:
    patch:
      consumes:
      - application/json
      description: Изменяет статус тикета по ID
      parameters:
      - description: ID тикета
        in: path
        name: id
        required: true
        type: integer
      - description: Новый статус
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handlers.UpdateStatusRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Статус обновлен
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Ошибка запроса
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Тикет не найден
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Внутренняя ошибка сервера
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Сменить статус тикета
      tags:
      - registrar
  /api/tickets/active:
    get:
      description: Возвращает список всех талонов в статусе 'ожидает' и 'приглашен'
        для первоначальной загрузки табло.
      produces:
      - application/json
      responses:
        "200":
          description: Список активных талонов
          schema:
            items:
              $ref: '#/definitions/models.TicketResponse'
            type: array
        "500":
          description: Внутренняя ошибка сервера
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Получить все активные талоны
      tags:
      - tickets
  /api/tickets/download/{ticket_number}:
    get:
      description: Позволяет скачать изображение талона по номеру
      parameters:
      - description: Номер талона
        in: path
        name: ticket_number
        required: true
        type: string
      produces:
      - image/png
      responses:
        "200":
          description: Изображение талона
          schema:
            type: file
        "400":
          description: 'Ошибка: не передан ticket_number'
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Талон не найден
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Скачать изображение талона
      tags:
      - tickets
  /api/tickets/print/confirmation:
    post:
      consumes:
      - application/json
      description: Обрабатывает подтверждение действия (печать талона или получение
        электронного)
      parameters:
      - description: Данные для подтверждения действия
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handlers.ConfirmationRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Ответ после подтверждения действия
          schema:
            $ref: '#/definitions/handlers.ConfirmationResponse'
        "400":
          description: 'Ошибка: не передан service_id или action'
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Внутренняя ошибка сервера
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Подтверждение действия
      tags:
      - tickets
  /api/tickets/print/selection:
    post:
      consumes:
      - application/json
      description: Определяет следующий шаг после выбора услуги
      parameters:
      - description: Данные для выбора услуги
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handlers.ServiceSelectionRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Следующий шаг после выбора услуги
          schema:
            $ref: '#/definitions/handlers.ServiceSelectionResponse'
        "400":
          description: 'Ошибка: не передан service_id'
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Выбор услуги
      tags:
      - tickets
  /api/tickets/services:
    get:
      consumes:
      - application/json
      description: Возвращает список доступных услуг
      produces:
      - application/json
      responses:
        "200":
          description: Список услуг
          schema:
            additionalProperties:
              items:
                $ref: '#/definitions/services.Service'
              type: array
            type: object
      summary: Получить список услуг
      tags:
      - tickets
  /api/tickets/start:
    get:
      consumes:
      - application/json
      description: Возвращает стартовую информацию для клиента (например, текст кнопки)
      produces:
      - application/json
      responses:
        "200":
          description: 'Успешный ответ: текст кнопки'
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Получить стартовую информацию
      tags:
      - tickets
  /api/tickets/view/{ticket_number}:
    get:
      description: Позволяет просмотреть изображение талона в браузере по номеру
      parameters:
      - description: Номер талона
        in: path
        name: ticket_number
        required: true
        type: string
      produces:
      - image/png
      responses:
        "200":
          description: Изображение талона
          schema:
            type: file
        "400":
          description: 'Ошибка: не передан ticket_number'
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Талон не найден
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Просмотр изображения талона
      tags:
      - tickets
securityDefinitions:
  ApiKeyAuth:
    in: header
    name: X-API-KEY
    type: apiKey
swagger: "2.0"
